<html>
  <head>
    <title>Express</title>

    <script
      type="text/javascript"
      src="https://code.jquery.com/jquery-3.4.1.min.js"
    ></script>
    <script>
      function LineLoginDirect() {
        $("#result").html(""); //清空顯示結果
        //另開popup window前，每次都取得新的LineLoginUrl(每次Url的state參數都不一樣)
        const response_type = "code";
        const client_id = "1657154166";
        const redirect_uri = "http://localhost:3000/cb"; //"https://intense-fortress-59028.herokuapp.com/";
        const state = "123123";
        const scope = "profile"; //URL += '&scope=openid%20profile%20email';
        const LineLoginUrl =
          "https://access.line.me/oauth2/v2.1/authorize" +
          "?response_type=" +
          response_type +
          "&client_id=" +
          client_id +
          "&redirect_uri=" +
          redirect_uri +
          "&state=" +
          state +
          "&scope=" +
          scope;
        // window.location.href = LineLoginUrl;

        $.ajax({
          url: "http://localhost:3000/login/authorize",
          type: "GET",
          headers: {
            "Access-Control-Allow-Origin": "*",
            "Access-Control-Allow-Methods":
              "GET, HEAD, POST, PUT, DELETE, TRACE, OPTIONS, PATCH",
            "Access-Control-Allow-Headers":
              "Origin,Accept,X-Requested-With,Content-Type,X-Amz-Date,Authorization,x-api-key,X-Amz-Security-Token",
          },
          crossDomain: true,
          success: function (url) {
            console.log("=============================" + url.data);
            // window.open(url, "_blank", "width=800px,height=600px");
          },
          error: function (xhr) {
            console.log("=============================" + xhr);
            console.log(xhr);
          },
        }); /*
              https://intense-fortress-59028.herokuapp.com/?code=uAAFwvxcxwmGSvIOQ9Oc&state=123123
      */
      }
    </script>
  </head>
  <body>
    <h1>Express</h1>
    <p>Welcome to Express</p>
    <a href="javascript:LineLoginDirect();"> Line Login </a>
    <div id="result"></div>
  </body>
</html>
